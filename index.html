<!doctype html>
<html lang="tr">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>A≈ükƒ±m Erkek Kuaf√∂r√º ‚Äì Randevu</title>
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@500;600&display=swap" rel="stylesheet">
<style>
:root{
  --bg:#0b0f13; --panel:#0f1317; --panel2:#151a20; --line:#2c323a;
  --text:#e7ecf3; --muted:#9aa6b2; --gold:#d4af37; --gold2:#d6ba55; --ctrl-h:42px;
}
*{box-sizing:border-box}
html,body{margin:0;padding:0;background:linear-gradient(180deg,#0c1116,#0a0e12);color:var(--text);
  font-family:'Poppins',-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,'Helvetica Neue',Arial,sans-serif}
/* Header centered */
.header{position:relative;max-width:960px;margin:0 auto;padding:20px 16px 10px 16px;display:flex;align-items:center;justify-content:space-between}
.brand{display:flex;align-items:center;gap:12px}
.logo{width:40px;height:40px;display:grid;place-items:center;border:2px solid var(--gold);border-radius:50%}
.logo::before{content:"‚úÇ";font-size:20px;color:var(--gold)}
.title{font-size:22px;font-weight:700;letter-spacing:.5px}
.btncol{display:flex;flex-direction:column;gap:10px}
.rightbtn{width:128px;height:34px;font-size:14px;border:1.5px solid var(--gold);border-radius:8px;
  padding:0 10px;display:flex;align-items:center;justify-content:center;gap:6px;background:transparent;color:#fff;cursor:pointer;transition:all .2s ease;text-decoration:none}
.rightbtn:hover{background:linear-gradient(90deg,var(--gold) 0%,#f8e473 100%);color:#000;box-shadow:0 0 8px rgba(212,175,55,.35)}

/* Main layout centered */
main{display:flex;justify-content:center;padding:0 16px 40px}
.container{width:100%;max-width:760px}

/* Card */
.card{background:var(--panel);border:1px solid var(--line);border-radius:14px;padding:18px;box-shadow:0 8px 30px rgba(0,0,0,.25)}
.sep{border:none;border-top:1px solid var(--line);margin:12px 0}
label{font-size:12px;color:#c8ced8;margin:0 0 6px 2px;font-weight:800}
select,input[type="text"],input[type="tel"],input[type="date"]{height:var(--ctrl-h);font-size:15px;border-radius:8px;padding:0 12px;background:var(--panel2);color:var(--text);border:1px solid var(--line);outline:none;width:100%}
select:focus,input:focus{box-shadow:0 0 0 2px #ffffff14}
.boxwrap{border:1px solid var(--line);border-radius:8px;background:var(--panel);padding:6px 8px}
.boxwrap input[type="date"]{height:var(--ctrl-h);background:transparent;border:none;padding:0 6px}
/* Form grid */
.controls{display:grid;grid-template-columns:1fr 1fr;gap:12px}
@media(max-width:640px){.controls{grid-template-columns:1fr}}

/* Time grid (visible on screen) */
.timegrid{display:grid;grid-template-columns:repeat(4,1fr);gap:8px;padding:8px;border:1px solid var(--line);border-radius:8px;background:var(--panel);min-height:calc(var(--ctrl-h) + 4px)}
@media(max-width:640px){.timegrid{grid-template-columns:repeat(2,1fr)}}
.cell{height:36px;display:flex;align-items:center;justify-content:center;border:1px solid var(--line);border-radius:8px;background:var(--panel2);color:var(--text);font-weight:600;cursor:pointer;user-select:none}
.cell.active{box-shadow:0 0 0 3px var(--gold2) inset}
.cell.disabled{opacity:.45;filter:grayscale(1);pointer-events:none;position:relative}
.cell.disabled::after{content:'DOLU';position:absolute;right:6px;bottom:4px;font-size:10px;color:#cbd4df}

/* Buttons */
button,.btn{height:42px;border:2px solid var(--gold);border-radius:8px;background:transparent;color:#fff;font-size:15px;font-weight:600;cursor:pointer;transition:all .25s ease}
button:hover,.btn:hover{background:linear-gradient(90deg,var(--gold) 0%, #f8e473 100%);color:#000;box-shadow:0 0 10px rgba(212,175,55,.4)}
button:active{transform:scale(.98)}
.small{height:36px;font-size:14px}
.cta{margin-top:12px;display:flex;gap:10px;justify-content:flex-end}

/* Lists */
.list{margin-top:10px;border:1px solid var(--line);border-radius:8px;background:#0f1216}
.list .item{display:flex;justify-content:space-between;align-items:center;padding:10px;border-bottom:1px solid #1b2129}
.list .item:last-child{border-bottom:none}
.muted{color:#9aa6b2;font-size:13px}

/* Toast */
.toast{position:fixed;left:50%;bottom:20px;transform:translateX(-50%);background:#111;border:1px solid var(--gold);border-radius:8px;padding:10px 14px;color:#fff;z-index:10001;display:none}
.toast.show{display:block}

/* Sections */
.section{display:none;margin-top:12px}
.section.active{display:block}
</style>
</head>
<body>
<header class="header">
  <div class="brand">
    <div class="logo"></div>
    <div class="title">A≈ükƒ±m Erkek Kuaf√∂r√º</div>
  </div>
  <div class="btncol">
    <a id="btnAdmin" class="rightbtn" href="#admin">üõ†Ô∏è Admin</a>
    <a id="btnUser" class="rightbtn" href="#user">üë§ M√º≈üteri</a>
  </div>
</header>

<main>
  <div class="container">
    <!-- 1) ANA EKRAN -->
    <section id="home" class="section active">
      <div class="card">
        <div class="controls">
          <div>
            <label>Berber</label>
            <select id="staff"><option value="">Farketmez</option></select>
          </div>
          <div>
            <label>Hizmet</label>
            <select id="service">
              <option value="">Hizmet se√ßin</option>
              <option value="Sa√ß" data-min="30">Sa√ß</option>
              <option value="Sakal" data-min="20">Sakal</option>
              <option value="Sa√ß + Sakal" data-min="45">Sa√ß + Sakal</option>
            </select>
          </div>
          <div>
            <label>Tarih</label>
            <div class="boxwrap"><input id="date" type="date"></div>
          </div>
          <div>
            <label>Saat</label>
            <div id="timegrid" class="timegrid" aria-live="polite"></div>
          </div>
        </div>

        <div class="controls" style="margin-top:10px">
          <div><label>Ad Soyad</label><input id="name" type="text" placeholder="Adƒ±nƒ±z ve Soyadƒ±nƒ±z"></div>
          <div><label>Telefon</label><input id="phone" type="tel" placeholder="05xxxxxxxxx"></div>
        </div>

        <div class="cta">
          <button id="bookBtn" type="button">Randevu Al</button>
          <button id="goUser" type="button" class="small">Randevularƒ±m</button>
        </div>
      </div>
    </section>

    <!-- 2) ADMIN EKRANI -->
    <section id="admin" class="section">
      <div class="card">
        <h3>üõ†Ô∏è Admin Giri≈üi</h3>
        <div id="loginBox">
          <input id="adminPass" type="password" placeholder="≈ûifre (Varsayƒ±lan: 2525)" style="width:100%;padding:10px;border-radius:8px;border:1px solid var(--line);background:#171b20;color:#fff">
          <div class="cta"><button id="adminLogin" type="button" class="small">Giri≈ü Yap</button></div>
        </div>
        <div id="panelBox" style="display:none">
          <h3>‚öôÔ∏è Ayarlar</h3>
          <div class="list" style="padding:12px">
            <div class="controls">
              <div><label>A√ßƒ±lƒ±≈ü</label><input id="setStart" type="time" value="09:00"></div>
              <div><label>Kapanƒ±≈ü</label><input id="setEnd" type="time" value="21:00"></div>
              <div><label>Adƒ±m (dakika)</label><input id="setStep" type="number" min="5" step="5" value="30"></div>
              <div><label>Berberler (virg√ºl ile)</label><input id="setBarbers" type="text" value="Ahmet,Aziz,Usta"></div>
            </div>
            <div class="cta"><button id="saveSettings" type="button" class="small">Kaydet</button></div>
          </div>

          <h3 style="margin-top:12px">üìã T√ºm Randevular</h3>
          <div id="adminList" class="list"></div>
        </div>
        <div class="cta"><button data-go="home" type="button" class="small">Ana Ekrana D√∂n</button></div>
      </div>
    </section>

    <!-- 3) M√ú≈ûTERƒ∞ EKRANI -->
    <section id="user" class="section">
      <div class="card">
        <h3>üë§ M√º≈üteri</h3>
        <div id="userBox">
          <input id="userName" type="text" placeholder="Ad Soyad" style="width:100%;padding:10px;border-radius:8px;border:1px solid var(--line);background:#171b20;color:#fff">
          <input id="userPass" type="password" placeholder="≈ûifre" style="width:100%;padding:10px;margin-top:6px;border-radius:8px;border:1px solid var(--line);background:#171b20;color:#fff">
          <div class="cta"><button id="userLogin" type="button" class="small">Giri≈ü Yap</button></div>
        </div>
        <div id="mineBox" style="display:none">
          <h3>üìå Randevularƒ±m</h3>
          <div id="mineList" class="list"></div>
        </div>
        <div class="cta"><button data-go="home" type="button" class="small">Ana Ekrana D√∂n</button></div>
      </div>
    </section>
  </div>
</main>

<div id="toast" class="toast"></div>

<script>
/* Storage helpers */
const KEY_SETTINGS='askim_settings';
const KEY_BOOKINGS='askim_bookings';
const KEY_USERS='askim_users';
const KEY_SESSION='askim_session';
function loadSettings(){const raw=localStorage.getItem(KEY_SETTINGS);if(raw){try{return JSON.parse(raw);}catch(e){}}return {start:'09:00', end:'21:00', step:30, barbers:['Ahmet','Aziz','Usta']};}
function saveSettings(s){localStorage.setItem(KEY_SETTINGS, JSON.stringify(s));}
function loadBookings(){const raw=localStorage.getItem(KEY_BOOKINGS);return raw?JSON.parse(raw):[];}
function saveBookings(a){localStorage.setItem(KEY_BOOKINGS, JSON.stringify(a));}
function loadUsers(){const raw=localStorage.getItem(KEY_USERS);return raw?JSON.parse(raw):[];}
function saveUsers(a){localStorage.setItem(KEY_USERS, JSON.stringify(a));}
function toast(msg){const t=document.getElementById('toast'); if(!t) return; t.textContent=msg; t.classList.add('show'); setTimeout(()=>t.classList.remove('show'),1800);}
function todayISO(){const t=new Date();const y=t.getFullYear();const m=String(t.getMonth()+1).padStart(2,'0');const d=String(t.getDate()).padStart(2,'0');return `${y}-${m}-${d}`;}

/* Router */
function show(id){document.querySelectorAll('.section').forEach(s=>s.classList.remove('active'));document.getElementById(id)?.classList.add('active');window.scrollTo({top:0,behavior:'smooth'});}
document.getElementById('btnAdmin').addEventListener('click',(e)=>{e.preventDefault();show('admin');});
document.getElementById('btnUser').addEventListener('click',(e)=>{e.preventDefault();show('user');});
document.querySelectorAll('[data-go="home"]').forEach(b=>b.addEventListener('click',()=>show('home')));
window.addEventListener('load',()=>{const h=location.hash.replace('#','');if(h){show(h);}});

/* Home */
function applyBarbers(){const s=loadSettings();const sel=document.getElementById('staff');sel.innerHTML='<option value=\"\">Farketmez</option>';s.barbers.forEach(b=>{const op=document.createElement('option');op.value=b.trim();op.textContent=b.trim();sel.appendChild(op);});}
function buildSlots(){
  const grid=document.getElementById('timegrid'); if(!grid) return; grid.innerHTML='';
  const date=(document.getElementById('date').value||'').trim(); if(!date) return;
  const SS=loadSettings(); const START=SS.start||'09:00'; const END=SS.end||'21:00'; let STEP=parseInt(SS.step||30,10); if(!STEP||STEP<5) STEP=30;
  const staffSel=(document.getElementById('staff').value||'').trim(); const barbers=(SS.barbers&&SS.barbers.length)?SS.barbers:['Ahmet','Aziz','Usta'];
  const all=loadBookings().filter(b=>b.date===date); const occ={}; all.forEach(b=>{const t=b.time;const st=(b.staff||'').trim(); if(!occ[t]) occ[t]=new Set(); if(st) occ[t].add(st);});
  const toHM=d=>String(d.getHours()).padStart(2,'0')+':'+String(d.getMinutes()).padStart(2,'0'); const addM=(d,m)=>{const x=new Date(d); x.setMinutes(x.getMinutes()+m); return x;};
  let cur=new Date(date+'T'+START+':00'), end=new Date(date+'T'+END+':00'); let appended=0;
  while(cur<=end){
    const hm=toHM(cur); const taken=occ[hm]||new Set(); const takenCount=[...taken].filter(s=>barbers.includes(s)).length;
    let disabled=false; if(staffSel){ disabled=taken.has(staffSel);} else { disabled=(takenCount>=barbers.length); }
    const c=document.createElement('div'); c.className='cell'; c.textContent=hm; c.dataset.time=hm; if(disabled) c.classList.add('disabled');
    c.addEventListener('click',()=>{ if(c.classList.contains('disabled')) return; document.querySelectorAll('.cell.active').forEach(x=>x.classList.remove('active')); c.classList.add('active'); },{passive:true});
    grid.appendChild(c); appended++; cur=addM(cur,STEP);
  }
  if(appended===0){ const m=document.createElement('div'); m.className='muted'; m.style.padding='8px'; m.textContent='Saat bulunamadƒ± ‚Äî l√ºtfen ayarlarƒ± kontrol edin.'; grid.appendChild(m);}
  else{ const firstFree=grid.querySelector('.cell:not(.disabled)'); if(firstFree) firstFree.classList.add('active'); }
}
document.addEventListener('DOMContentLoaded',()=>{ applyBarbers(); const d=document.getElementById('date'); if(d && !d.value) d.value=todayISO(); buildSlots(); });
['date','staff','service'].forEach(id=>{ document.getElementById(id)?.addEventListener('change', buildSlots); });

/* Booking */
document.getElementById('bookBtn').addEventListener('click',()=>{
  const name=(document.getElementById('name').value||'').trim();
  const phone=(document.getElementById('phone').value||'').trim();
  const date=(document.getElementById('date').value||'').trim();
  const service=(document.getElementById('service').value||'').trim();
  const staff=(document.getElementById('staff').value||'').trim();
  const act=document.querySelector('.cell.active');
  if(!name||!phone){ toast('Ad & Telefon gerekli'); return; }
  if(!date){ toast('Tarih se√ßin'); return; }
  if(!act){ toast('Saat se√ßin'); return; }
  const time=act.dataset.time;
  const SS=loadSettings(); const barbers=(SS.barbers&&SS.barbers.length)?SS.barbers:['Ahmet','Aziz','Usta'];
  const arr=loadBookings();
  if(staff){ if(arr.some(b=>b.date===date && b.time===time && (b.staff||'')===staff)){ toast('Bu berber o saatte dolu'); return; } }
  else{ const takenBy=new Set(arr.filter(b=>b.date===date && b.time===time).map(b=>b.staff).filter(Boolean)); if(takenBy.size>=barbers.length){ toast('Bu saat tamamen dolu'); return; } }
  const sess=JSON.parse(localStorage.getItem(KEY_SESSION)||'{}'); const userId=sess.user||null;
  const rec={id:'b'+Date.now(), name, phone, date, time, service, staff, userId};
  arr.push(rec); saveBookings(arr); toast('‚úÖ Randevu olu≈üturuldu'); buildSlots();
});

/* Admin */
function refreshAdminList(){
  const list=document.getElementById('adminList'); list.innerHTML='';
  const arr=loadBookings().sort((a,b)=>(a.date+a.time).localeCompare(b.date+b.time));
  if(!arr.length){ list.innerHTML='<div class="muted" style="padding:10px">Kayƒ±t yok</div>'; return; }
  arr.forEach(rec=>{
    const row=document.createElement('div'); row.className='item';
    const left=document.createElement('div');
    left.innerHTML = `<strong>${rec.date} ${rec.time}</strong> ‚Ä¢ ${rec.staff||'Farketmez'} ‚Ä¢ ${rec.service||'-'}<div class="muted">${rec.name} ‚Äî ${rec.phone}</div>`;
    const del=document.createElement('button'); del.className='small'; del.textContent='Sil';
    del.addEventListener('click',()=>{ const all=loadBookings().filter(x=>x.id!==rec.id); saveBookings(all); refreshAdminList(); toast('Silindi'); });
    row.appendChild(left); row.appendChild(del); list.appendChild(row);
  });
}
document.getElementById('adminLogin').addEventListener('click',()=>{
  const pass=(document.getElementById('adminPass').value||'').trim();
  if(pass==='2525'){
    document.getElementById('loginBox').style.display='none'; document.getElementById('panelBox').style.display='block';
    const s=loadSettings();
    document.getElementById('setStart').value=s.start; document.getElementById('setEnd').value=s.end;
    document.getElementById('setStep').value=s.step; document.getElementById('setBarbers').value=s.barbers.join(',');
    refreshAdminList(); toast('Giri≈ü ba≈üarƒ±lƒ±');
  }else{ toast('‚ùå ≈ûifre yanlƒ±≈ü'); }
});
document.getElementById('saveSettings').addEventListener('click',()=>{
  const s=loadSettings();
  s.start=(document.getElementById('setStart').value||'09:00');
  s.end=(document.getElementById('setEnd').value||'21:00');
  s.step=parseInt(document.getElementById('setStep').value||30,10)||30;
  const bl=(document.getElementById('setBarbers').value||'').split(',').map(x=>x.trim()).filter(Boolean);
  if(bl.length) s.barbers=bl;
  saveSettings(s); toast('Ayarlar kaydedildi'); buildSlots();
});

/* User */
function showMine(){
  const sess=JSON.parse(localStorage.getItem(KEY_SESSION)||'{}'); if(!sess.user){ return; }
  document.getElementById('userBox').style.display='none'; document.getElementById('mineBox').style.display='block';
  const list=document.getElementById('mineList'); list.innerHTML='';
  const arr=loadBookings().filter(b=>b.userId===sess.user).sort((a,b)=>(a.date+a.time).localeCompare(b.date+b.time));
  if(!arr.length){ list.innerHTML='<div class="muted" style="padding:10px">Kayƒ±t yok</div>'; return; }
  arr.forEach(rec=>{
    const row=document.createElement('div'); row.className='item';
    const left=document.createElement('div'); left.innerHTML=`<strong>${rec.date} ${rec.time}</strong> ‚Ä¢ ${rec.staff||'Farketmez'} ‚Ä¢ ${rec.service||'-'}`;
    const del=document.createElement('button'); del.className='small'; del.textContent='ƒ∞ptal';
    del.addEventListener('click',()=>{ const all=loadBookings().filter(x=>x.id!==rec.id); saveBookings(all); toast('ƒ∞ptal edildi'); showMine(); });
    row.appendChild(left); row.appendChild(del); list.appendChild(row);
  });
}
document.getElementById('userLogin').addEventListener('click',()=>{
  const name=(document.getElementById('userName').value||'').trim();
  const pass=(document.getElementById('userPass').value||'').trim();
  if(!name||!pass){ toast('Bilgileri doldurun'); return; }
  const users=loadUsers(); let u=users.find(x=>x.name===name);
  if(!u){ u={id:'u'+Date.now(), name, pass}; users.push(u); saveUsers(users); }
  if(u.pass!==pass){ toast('≈ûifre yanlƒ±≈ü'); return; }
  localStorage.setItem(KEY_SESSION, JSON.stringify({user:u.id, name:u.name}));
  toast('Ho≈ü geldin '+u.name); showMine();
});
document.getElementById('goUser').addEventListener('click',()=>{
  show('user');
  const sess=JSON.parse(localStorage.getItem(KEY_SESSION)||'{}');
  if(sess.user){ showMine(); }
});
</script>
</body>
</html>
